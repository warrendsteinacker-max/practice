<!DOCTYPE html>
<html>
<head>
    <title>Interactive Curried Calculator</title>
</head>
<body>
    <button id="startCalc">Start Calculation Chain</button>
    <p>Open the console (F12) to see execution logs.</p>

    <script>
        // Global state variables to hold the values obtained from the prompts
        let operandA, operator, operandB; 

        /**
         * Main function that initiates the calculation sequence.
         * It reads the first operand and returns the next function in the chain.
         */
        const calculate = () => {
            
            // --- Stage 1: Get Operand A ---
            const aInput = prompt('Step 1: What is the first number (A)?');
            if (aInput === null) return null; // Exit on cancel
            operandA = parseFloat(aInput);
            
            // Return the function for Stage 2 (getting the operator)
            return () => {
                
                // --- Stage 2: Get Operator ---
                const opInput = prompt('Step 2: What operation (+, -, *, /) to do with A?');
                if (opInput === null) return null; // Exit on cancel
                operator = opInput;
                
                // Return the function for Stage 3 (getting the second number and calculating)
                return () => {

                    // --- Stage 3: Get Operand B ---
                    const bInput = prompt('Step 3: What is the second number (B)?');
                    if (bInput === null) return null; // Exit on cancel
                    operandB = parseFloat(bInput);
                    
                    // --- Final Execution ---
                    let result;
                    
                    if (isNaN(operandA) || isNaN(operandB)) {
                        result = 'Error: Invalid number input.';
                    } else {
                        switch (operator) {
                            case '+':
                                result = operandA + operandB;
                                break;
                            case '-':
                                result = operandA - operandB;
                                break;
                            case '*':
                                result = operandA * operandB;
                                break;
                            case '/':
                                result = operandB === 0 ? 'Error: Division by zero' : operandA / operandB;
                                break;
                            default:
                                result = 'Error: Invalid operator.';
                                break;
                        }
                    }

                    // Output the result and return the start of the chain.
                    console.log(`Calculation: ${operandA} ${operator} ${operandB} = ${result}`);
                    alert(`Result: ${result}`);
                    
                    // The final step returns the starting function again!
                    return calculate; 
                };
            };
        };

        // Function to start the chain from the button click
        function startChain() {
            // Start the first step
            const step2 = calculate(); 
            if (!step2) return;
            
            // Execute the second step
            const step3 = step2();
            if (!step3) return;

            // Execute the final step (which returns the 'calculate' function reference)
            const restartFunction = step3();
            
            // You can optionally call the returned function to force a restart:
            // if (restartFunction) restartFunction(); 
        }

        document.getElementById('startCalc').onclick = startChain;
    </script>
</body>
</html>